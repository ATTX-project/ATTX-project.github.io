
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>UVProvovenance Service Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-git-author/style.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="ATTX-Component-Graph.html" />
    
    
    <link rel="prev" href="Unified-Views-plugins.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        <li class="header">ATTX Project</li>
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    ATTX Project
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" >
            
                <span>
            
                    
                    Applications and Use Cases
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="Use-case-Infrastructures-and-publications.html">
            
                <a href="Use-case-Infrastructures-and-publications.html">
            
                    
                    UC1 - Infrastructure and Publications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="Use-case-Jyvaskyla.html">
            
                <a href="Use-case-Jyvaskyla.html">
            
                    
                    UC2 - Parallel Publication Dashboard
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="Use-case-Metax.html">
            
                <a href="Use-case-Metax.html">
            
                    
                    UC3 - Metax
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="Use-case-Mildred.html">
            
                <a href="Use-case-Mildred.html">
            
                    
                    UC4 - Mildred
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="ATTX-Architecture-Overview.html">
            
                <a href="ATTX-Architecture-Overview.html">
            
                    
                    ATTX Architecture Overview
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Getting Started</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="ATTX-Broker-Deployment.html">
            
                <a href="ATTX-Broker-Deployment.html">
            
                    
                    ATTX Broker Deployment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" >
            
                <span>
            
                    
                    Run on Single Machine PC/Mac/VM
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1.1" data-path="Building-Docker-application-stacks-in-Swarm-Mode.html">
            
                <a href="Building-Docker-application-stacks-in-Swarm-Mode.html">
            
                    
                    Building Swarm Mode on a PC/Mac
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.1.2" data-path="Running-the-ATTX-containerised-application-stack-in-your-own-PC-or-Mac.html">
            
                <a href="Running-the-ATTX-containerised-application-stack-in-your-own-PC-or-Mac.html">
            
                    
                    Running the ATTX Stack on a PC/Mac
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.2" >
            
                <span>
            
                    
                    Run on Distributed/Cloud
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.2.1" data-path="Provisioning-ATTX-Components-on-CSC-Open-Stack-cPouta.html">
            
                <a href="Provisioning-ATTX-Components-on-CSC-Open-Stack-cPouta.html">
            
                    
                    Provisioning ATTX Components on CSC Open Stack (cPouta)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.2" data-path="Deploying-ATTX-Components-on-Docker-Swarm.html">
            
                <a href="Deploying-ATTX-Components-on-Docker-Swarm.html">
            
                    
                    Deploying ATTX Components on Docker Swarm
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.3" data-path="Shared-NFS-Swarm-Cloud.html">
            
                <a href="Shared-NFS-Swarm-Cloud.html">
            
                    
                    Setting-up a shared NFS filesystem in Docker Swarm running in CSC cPouta
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2.4" data-path="Applying-Rolling-Updates-to-services-in-Docker-Swarm.html">
            
                <a href="Applying-Rolling-Updates-to-services-in-Docker-Swarm.html">
            
                    
                    Applying Rolling Updates to Services in Docker Swarm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="Deploying-ATTX-SB-on-Kontena.html">
            
                <a href="Deploying-ATTX-SB-on-Kontena.html">
            
                    
                    Deploying ATTX Broker on Kontena
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Core Components</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="ATTX-Component-Workflow.html">
            
                <a href="ATTX-Component-Workflow.html">
            
                    
                    Workflow Component
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="ETL-Artifacts.html">
            
                <a href="ETL-Artifacts.html">
            
                    
                    ETL Artifacts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="Unified-Views-plugins.html">
            
                <a href="Unified-Views-plugins.html">
            
                    
                    UnifiedViews Plugins
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="3.1.3" data-path="Service-UVProvenance.html">
            
                <a href="Service-UVProvenance.html">
            
                    
                    UVProvovenance Service
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="ATTX-Component-Graph.html">
            
                <a href="ATTX-Component-Graph.html">
            
                    
                    Graph Component
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1" data-path="Service-Graph-Manager.html">
            
                <a href="Service-Graph-Manager.html">
            
                    
                    Graph Manager Service
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.1.1" data-path="Examples-Graph-Manager-Service.html">
            
                <a href="Examples-Graph-Manager-Service.html">
            
                    
                    Graph Manager Message Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.2" data-path="Graph-Store.html">
            
                <a href="Graph-Store.html">
            
                    
                    Graph Store
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.2.2.1" data-path="ATTX-Data-Model.html">
            
                <a href="ATTX-Data-Model.html">
            
                    
                    Ontology/Data model
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2.3" data-path="Linking-Strategies.html">
            
                <a href="Linking-Strategies.html">
            
                    
                    Linking Strategies
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="ATTX-Component-Distribution.html">
            
                <a href="ATTX-Component-Distribution.html">
            
                    
                    Distribution Component
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.3.1" data-path="ElasticSearch-with-Siren.html">
            
                <a href="ElasticSearch-with-Siren.html">
            
                    
                    ElasticSearch 1.3 with Siren
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.2" data-path="ElasticSearch-5.html">
            
                <a href="ElasticSearch-5.html">
            
                    
                    ElasticSearch 5.x
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.3.3" data-path="Dissemination-Workflow.html">
            
                <a href="Dissemination-Workflow.html">
            
                    
                    How Dissemination worflows work
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="ATTX-Component-ServiceDiscovery.html">
            
                <a href="ATTX-Component-ServiceDiscovery.html">
            
                    
                    Service Discovery
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.4.1" data-path="Consul-ServiceDiscovery-Implementation.html">
            
                <a href="Consul-ServiceDiscovery-Implementation.html">
            
                    
                    Consul Service Discovery Implementation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.4.2" data-path="Consul-for-Service-Discovery-on-Docker-Swarm.html">
            
                <a href="Consul-for-Service-Discovery-on-Docker-Swarm.html">
            
                    
                    Consul for Service Discovery on Docker Swarm
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="ATTX-Component-MessageBroker.html">
            
                <a href="ATTX-Component-MessageBroker.html">
            
                    
                    Message Broker
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.5.1" data-path="MessageBroker-ActiveMQ.html">
            
                <a href="MessageBroker-ActiveMQ.html">
            
                    
                    ActiveMQ Message Broker
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.5.2" data-path="MessageBroker-RabbitMQ.html">
            
                <a href="MessageBroker-RabbitMQ.html">
            
                    
                    RabbitMQ Message Broker
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Broker Services</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="Service-Provenance.html">
            
                <a href="Service-Provenance.html">
            
                    
                    Provenance Service
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="Examples-Provenance-Service.html">
            
                <a href="Examples-Provenance-Service.html">
            
                    
                    Provenance Messages Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="Service-RML.html">
            
                <a href="Service-RML.html">
            
                    
                    RML Service
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.2.1" data-path="Examples-RML-Service.html">
            
                <a href="Examples-RML-Service.html">
            
                    
                    RML Messages Examples
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4.3" data-path="Service-Indexing.html">
            
                <a href="Service-Indexing.html">
            
                    
                    Indexing Service
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="Service-Graph-Framing.html">
            
                <a href="Service-Graph-Framing.html">
            
                    
                    Graph Framing Service
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">User Guide</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="User-Guide-Administrator.html">
            
                <a href="User-Guide-Administrator.html">
            
                    
                    Data Administrator's User guide
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Development Guidelines</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="ATTX-Development-Environment.html">
            
                <a href="ATTX-Development-Environment.html">
            
                    
                    ATTX Development Environment
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="Feature-roadmap.html">
            
                <a href="Feature-roadmap.html">
            
                    
                    Feature Roadmap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="Release-Plan.html">
            
                <a href="Release-Plan.html">
            
                    
                    Release Plan
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="CI-CD-Enviroment.html">
            
                <a href="CI-CD-Enviroment.html">
            
                    
                    CI/CD Enviroment
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.4.1" data-path="Jenkins-CI.html">
            
                <a href="Jenkins-CI.html">
            
                    
                    Jenkins CI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4.2" data-path="Build-Environment-Setup.html">
            
                <a href="Build-Environment-Setup.html">
            
                    
                    Build Environment Setup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.4.3" data-path="Containerized-testing.html">
            
                <a href="Containerized-testing.html">
            
                    
                    Containerized Testing
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Reports & Contributions</li>
        
        
    
        <li class="chapter " data-level="7.1" >
            
                <span>
            
                    
                    Reports
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.1.1" data-path="CSC-cPouta-Cloud-Services-Report.html">
            
                <a href="CSC-cPouta-Cloud-Services-Report.html">
            
                    
                    CSC cPouta Cloud Services Report
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.2" data-path="Building-with-Gradle.html">
            
                <a href="Building-with-Gradle.html">
            
                    
                    Building with (Py)Gradle
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.3" data-path="Messaging-Brokers-Solutions.html">
            
                <a href="Messaging-Brokers-Solutions.html">
            
                    
                    Messaging Brokers Solutions Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.4" data-path="Service-Discovery-Solutions.html">
            
                <a href="Service-Discovery-Solutions.html">
            
                    
                    Service Discovery Solutions Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.5" data-path="Workflow-Management-Tools.html">
            
                <a href="Workflow-Management-Tools.html">
            
                    
                    Workflow Management Tools Overview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.1.6" data-path="Solutions-API-Gateway.html">
            
                <a href="Solutions-API-Gateway.html">
            
                    
                    API Gateway Solutions Overview
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.2" >
            
                <span>
            
                    
                    Presentations
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="7.2.1" data-path="Presentation-ELAG-2017.html">
            
                <a href="Presentation-ELAG-2017.html">
            
                    
                    ELAG2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.2" data-path="Presentation-OSFair-2017.html">
            
                <a href="Presentation-OSFair-2017.html">
            
                    
                    OSFair2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.3" data-path="Presentation-SWIB-2017.html">
            
                <a href="Presentation-SWIB-2017.html">
            
                    
                    SWIB2017
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="7.2.4" data-path="Presentation-ISWC-2017.html">
            
                <a href="Presentation-ISWC-2017.html">
            
                    
                    ISWC2017
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7.3" data-path="Open-Contributions.html">
            
                <a href="Open-Contributions.html">
            
                    
                    Open Source Contributions
            
                </a>
            

            
        </li>
    

    
        
        <li class="divider"></li>
        
        
    
        <li class="chapter " data-level="8.1" >
            
                <a target="_blank" href="https://www.helsinki.fi/en/projects/attx-2016">
            
                    
                    ATTX website
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >UVProvovenance Service</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <div class="git-author-container git-author-top"><div class="modified">Current page last modified at: 17-Nov-2017 09:52:43</div></div><h1 id="uvprovenance-api">UVProvenance API</h1>
<h3 id="table-of-contents">Table of Contents</h3>
<!-- TOC START min:1 max:3 link:true update:false -->
<ul>
<li><a href="#overview">Overview</a></li>
<li><a href="#building-the-uvprovenance-api">Building the UVProvenance-API</a><ul>
<li><a href="#database-connection">Database Connection</a></li>
</ul>
</li>
<li><a href="#consuming-the-uvprovenance-api">Consuming the UVProvenance-API</a><ul>
<li><a href="#health-endpoint">health Endpoint</a></li>
<li><a href="#provjob-endpoint">provjob Endpoint</a></li>
<li><a href="#workflow-endpoint">workflow Endpoint</a></li>
<li><a href="#activity-endpoint">activity Endpoint</a></li>
</ul>
</li>
<li><a href="#uvprovenance-with-messaging-queues">UVProvenance with Messaging Queues</a></li>
<li><a href="#how-the-information-is-extracted">How the Information is Extracted</a></li>
</ul>
<!-- TOC END -->
<h2 id="overview">Overview</h2>
<p>The UV (UnifiedViews) Provenance REST API has three endpoints along with a health check endpoint:</p>
<ul>
<li><code>workflow</code> - retrieve all the workflows and associated steps from the ETL Artifact;</li>
<li><code>activity</code> - retrieve all successfully completed activities and associated datasets from the ETL Artifact;</li>
<li><code>provjob</code> - start the provenance update job without waiting for the scheduled run;</li>
<li><code>health</code> - checks if the application is running.</li>
</ul>
<p>The general purpose of the UV Provenance API is to review metadata for workflows and activities such that it exposes information that is according with the <a href="ATTX-Data-Model.html">Ontology/Data model</a>. Such information could not easily be obtained directly from the <a href="https://grips.semantic-web.at/display/UDDOC/UnifiedViews+REST+API" target="_blank">UnifiedViews REST API</a>. Moreover the configuration necessary to extract this information is encoded in the Pipeline DPU configuration, as depicted in examples below.</p>
<p>Current version: <code>0.2</code> (URL for the endpoint should take into consideration for the API <code>http://host:4301/version/endpoint</code>).</p>
<p>The UV Provenance application also has a Message-based communication part, which implements a basic message Producer that will send provenance messages as described in the <a href="Provenance-Service.md">Provenance Service</a> to a specific queue (in our case <code>provenance.inbox</code>) in order to update the (missing) provenance information in the Graph Store.</p>
<h2 id="building-the-uvprovenance-api">Building the UVProvenance-API</h2>
<p>For building the UVProvenance-API see:</p>
<ul>
<li><a href="https://github.com/ATTX-project/uv-provenance-service" target="_blank">UVProvenance-API source</a> - repository</li>
<li>Docker Image build - <a href="https://github.com/ATTX-project/platform-deployment/tree/dev/service-uvprov" target="_blank">https://github.com/ATTX-project/platform-deployment/tree/dev/service-uvprov</a></li>
<li>short tutorial on <a href="Building-with-Gradle.html">Gradle</a></li>
</ul>
<h3 id="database-connection">Database Connection</h3>
<p>In order to run the tests successfully but also the UVProvenance-API successfully one would require an existing MYSQL database connection on which the UnifiedViews runs. Such a connection can be configured in Docker file via the environment variables:</p>
<ul>
<li><code>MHOST</code> - container name or address for the MessageBroker-RabbitMQ database (defaults to <code>localhost</code>);</li>
<li><code>MUSER</code> - user name for MessageBroker (defaults to <code>user</code>);</li>
<li><code>MQUEUE</code> - provenance queue in the MessageBroker (defaults to <code>provenance.inbox</code>);</li>
<li><code>MKEY</code> - password for MessageBroker (defaults to <code>password</code>);</li>
<li><code>DBHOST</code> - container name or address for the MYSQL database (defaults to localhost);</li>
<li><code>DBUSER</code> - database user name;</li>
<li><code>DBKEY</code> - password or key for the database user;</li>
<li><code>DBASE</code> - table which to access (defaults to <code>unified_views</code>);</li>
<li><code>QTIME</code> - variable to set up the timer for publisher (defaults to 30 and input must be integer).</li>
</ul>
<p>At the same time it can be troubleshoot using the docker container:</p>
<ul>
<li>connect to the running UVProvenance-API Docker container <code>docker exec -it container-id /bin/sh</code> (replace <code>container-id</code> with the ID of the docker container)</li>
<li>run python</li>
<li>in the python shell:<ul>
<li><code>import pymysql as mysql</code></li>
<li><code>mysql.connect(host=&apos;addressOfDBServer&apos;, port=3306, user=&apos;username&apos;, passwd=&apos;password&apos;, db=&apos;database&apos;, charset=&apos;utf8&apos;)</code> - replace the variables in <code>&apos;&apos;</code> with the correct information. Running this command with help with debugging mysql connection issues.</li>
</ul>
</li>
</ul>
<h2 id="consuming-the-uvprovenance-api">Consuming the UVProvenance-API</h2>
<p>As specified above the UV Provenance API has two endpoints:</p>
<ul>
<li><code>workflow</code> - retrieve all the workflows and associated steps from the ETL Artifact (only GET method possible);</li>
<li><code>activity</code> - retrieve all successfully completed activities and associated datasets from the ETL Artifact (only GET method possible).</li>
<li><code>provjob</code> - start the provenance update job without waiting for the scheduled run (only GET method possible) - responds with <code>202</code>;</li>
<li><code>health</code> - responds with <code>200</code> so that we know the service is alive.</li>
</ul>
<h3 id="health-endpoint">health Endpoint</h3>
<ul>
<li><code>health</code> GET API:<ul>
<li>simple: <a href="http://localhost:4301/health" target="_blank">http://localhost:4301/health</a> responds with <code>200</code> in order for other applications to know the service is running.</li>
</ul>
</li>
</ul>
<h3 id="provjob-endpoint">provjob Endpoint</h3>
<ul>
<li><code>provjob</code> GET API:<ul>
<li>simple: <a href="http://localhost:4301/provjob" target="_blank">http://localhost:4301/provjob</a> responds with <code>202</code> in order to start the provenance update job without waiting for the scheduled run.</li>
</ul>
</li>
</ul>
<h3 id="workflow-endpoint">workflow Endpoint</h3>
<ul>
<li><p><code>workflow</code> GET API:</p>
<ul>
<li>simple: <a href="http://localhost:4301/0.2/workflow" target="_blank">http://localhost:4301/0.2/workflow</a></li>
<li>Responses: if status codes are <code>304</code> No Modified or <code>405</code> Method Not Allowed the response body is empty. If the Response status is <code>200</code> it will return data specific to workflows:</li>
</ul>
<pre><code class="lang-json">  [
    {
     <span class="hljs-string">&quot;provenance&quot;</span>: {
         <span class="hljs-string">&quot;context&quot;</span>: {
             <span class="hljs-string">&quot;activityID&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,
             <span class="hljs-string">&quot;stepID&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,
             <span class="hljs-string">&quot;workflowID&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>
         },
         <span class="hljs-string">&quot;agent&quot;</span>: {
             <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;ETL&quot;</span>,
             <span class="hljs-string">&quot;ID&quot;</span>: <span class="hljs-string">&quot;UnifiedViews&quot;</span>
         },
         <span class="hljs-string">&quot;activity&quot;</span>: {
             <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>,
             <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;StepExecution&quot;</span>,
             <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;uv-dpu-l-attx-uploader&quot;</span>
         }
     },
     <span class="hljs-string">&quot;payload&quot;</span>: {}
  },
  {
     <span class="hljs-string">&quot;provenance&quot;</span>: {
         <span class="hljs-string">&quot;context&quot;</span>: {
             <span class="hljs-string">&quot;activityID&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,
             <span class="hljs-string">&quot;stepID&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,
             <span class="hljs-string">&quot;workflowID&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>
         },
         <span class="hljs-string">&quot;agent&quot;</span>: {
             <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;ETL&quot;</span>,
             <span class="hljs-string">&quot;ID&quot;</span>: <span class="hljs-string">&quot;UnifiedViews&quot;</span>
         },
         <span class="hljs-string">&quot;activity&quot;</span>: {
             <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;failed&quot;</span>,
             <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;StepExecution&quot;</span>,
             <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;uv-t-sparqlConstruct&quot;</span>
         }
     },
     <span class="hljs-string">&quot;payload&quot;</span>: {}
  }
  ]
</code></pre>
<h3 id="activity-endpoint">activity Endpoint</h3>
</li>
<li><p><code>activity</code> GET API:</p>
<ul>
<li>simple: <a href="http://localhost:4301/0.2/activity" target="_blank">http://localhost:4301/0.2/activity</a></li>
<li>Responses: if status codes are <code>304</code> No Modified or <code>405</code> Method Not Allowed the response body is empty. If the Response status is <code>200</code> it will return data specific to activites:</li>
</ul>
<pre><code class="lang-json">[
    {
        <span class="hljs-string">&quot;provenance&quot;</span>: {
            <span class="hljs-string">&quot;context&quot;</span>: {
                <span class="hljs-string">&quot;activityID&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>,
                <span class="hljs-string">&quot;workflowID&quot;</span>: <span class="hljs-string">&quot;1&quot;</span>
            },
            <span class="hljs-string">&quot;agent&quot;</span>: {
                <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;ETL&quot;</span>,
                <span class="hljs-string">&quot;ID&quot;</span>: <span class="hljs-string">&quot;UnifiedViews&quot;</span>
            },
            <span class="hljs-string">&quot;activity&quot;</span>: {
                <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;warning&quot;</span>,
                <span class="hljs-string">&quot;endTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T06:51:03&quot;</span>,
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;WorkflowExecution&quot;</span>,
                <span class="hljs-string">&quot;startTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T06:51:03&quot;</span>,
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;name Activity2&quot;</span>
            }
        },
        <span class="hljs-string">&quot;payload&quot;</span>: {}
    },
    {
        <span class="hljs-string">&quot;provenance&quot;</span>: {
            <span class="hljs-string">&quot;context&quot;</span>: {
                <span class="hljs-string">&quot;activityID&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>,
                <span class="hljs-string">&quot;workflowID&quot;</span>: <span class="hljs-string">&quot;2&quot;</span>
            },
            <span class="hljs-string">&quot;agent&quot;</span>: {
                <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;ETL&quot;</span>,
                <span class="hljs-string">&quot;ID&quot;</span>: <span class="hljs-string">&quot;UnifiedViews&quot;</span>
            },
            <span class="hljs-string">&quot;activity&quot;</span>: {
                <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;success&quot;</span>,
                <span class="hljs-string">&quot;endTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T11:39:12&quot;</span>,
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;WorkflowExecution&quot;</span>,
                <span class="hljs-string">&quot;startTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T11:39:12&quot;</span>,
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;ceva Activity3&quot;</span>
            }
        },
        <span class="hljs-string">&quot;payload&quot;</span>: {}
    },
    {
        <span class="hljs-string">&quot;provenance&quot;</span>: {
            <span class="hljs-string">&quot;context&quot;</span>: {
                <span class="hljs-string">&quot;activityID&quot;</span>: <span class="hljs-string">&quot;4&quot;</span>,
                <span class="hljs-string">&quot;workflowID&quot;</span>: <span class="hljs-string">&quot;3&quot;</span>
            },
            <span class="hljs-string">&quot;agent&quot;</span>: {
                <span class="hljs-string">&quot;role&quot;</span>: <span class="hljs-string">&quot;ETL&quot;</span>,
                <span class="hljs-string">&quot;ID&quot;</span>: <span class="hljs-string">&quot;UnifiedViews&quot;</span>
            },
            <span class="hljs-string">&quot;activity&quot;</span>: {
                <span class="hljs-string">&quot;status&quot;</span>: <span class="hljs-string">&quot;failed&quot;</span>,
                <span class="hljs-string">&quot;endTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T11:40:16&quot;</span>,
                <span class="hljs-string">&quot;type&quot;</span>: <span class="hljs-string">&quot;WorkflowExecution&quot;</span>,
                <span class="hljs-string">&quot;startTime&quot;</span>: <span class="hljs-string">&quot;2017-09-06T11:40:16&quot;</span>,
                <span class="hljs-string">&quot;title&quot;</span>: <span class="hljs-string">&quot;error pipeline Activity4&quot;</span>
            }
        },
        <span class="hljs-string">&quot;payload&quot;</span>: {}
    }
]
</code></pre>
</li>
<li><code>activity</code> and <code>workflow</code> POST APIs will return <code>405</code> as this operation current is not allowed.</li>
</ul>
<h2 id="uvprovenance-with-message-broker">UVProvenance with Message Broker</h2>
<p>The UVProvenance update can work with the <a href="MessageBroker-RabbitMQ.html">RabbitMQ Message Broker</a> in order to update the provenance in the Graph Store. It will send the message to the <code>provenance.inbox</code> queue every 30 minutes.
By default it processes all activities and worfklows, in order to update the provenance information if it changed - e.g. an activity was run with new parameters and its status changed from <code>failed</code> to <code>success</code>.</p>
<h2 id="how-the-information-is-extracted">How the Information is Extracted</h2>
<p>Extracting information associated to the provenance and workflow information can be classified in three types:</p>
<ul>
<li>Database information related to pipelines and pipeline execution.</li>
</ul>
<p>Information specific to workflows and activities is extracted directly from the MySQL database for example activities and associated information are extracted from pipeline executions.</p>
<pre><code class="lang-sql"><span class="hljs-keyword">SELECT</span> exec_pipeline.id <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;activityId&apos;</span>,
ppl_model.id <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;workflowId&apos;</span>,
exec_pipeline.t_start <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;activityStart&apos;</span>,
exec_pipeline.t_end <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;activityEnd&apos;</span>,
exec_pipeline.t_end <span class="hljs-keyword">AS</span> <span class="hljs-string">&apos;lastChange&apos;</span>
<span class="hljs-keyword">FROM</span> exec_pipeline, ppl_model
<span class="hljs-keyword">WHERE</span> exec_pipeline.pipeline_id = ppl_model.id <span class="hljs-keyword">AND</span>\
exec_pipeline.status = <span class="hljs-number">5</span>
<span class="hljs-keyword">ORDER</span> <span class="hljs-keyword">BY</span> ppl_model.id
</code></pre>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="Unified-Views-plugins.html" class="navigation navigation-prev " aria-label="Previous page: UnifiedViews Plugins">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="ATTX-Component-Graph.html" class="navigation navigation-next " aria-label="Next page: Graph Component">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"UVProvovenance Service","level":"3.1.3","depth":2,"next":{"title":"Graph Component","level":"3.2","depth":1,"path":"ATTX-Component-Graph.md","ref":"ATTX-Component-Graph.md","articles":[{"title":"Graph Manager Service","level":"3.2.1","depth":2,"path":"Service-Graph-Manager.md","ref":"Service-Graph-Manager.md","articles":[{"title":"Graph Manager Message Examples","level":"3.2.1.1","depth":3,"path":"Examples-Graph-Manager-Service.md","ref":"Examples-Graph-Manager-Service.md","articles":[]}]},{"title":"Graph Store","level":"3.2.2","depth":2,"path":"Graph-Store.md","ref":"Graph-Store.md","articles":[{"title":"Ontology/Data model","level":"3.2.2.1","depth":3,"path":"ATTX-Data-Model.md","ref":"ATTX-Data-Model.md","articles":[]}]},{"title":"Linking Strategies","level":"3.2.3","depth":2,"path":"Linking-Strategies.md","ref":"Linking-Strategies.md","articles":[]}]},"previous":{"title":"UnifiedViews Plugins","level":"3.1.2","depth":2,"path":"Unified-Views-plugins.md","ref":"Unified-Views-plugins.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":["highlight","fontsettings","search","git-author","gitversion","copy-code-button"],"pluginsConfig":{"gitversion":{},"git-author":{"position":"top","modifyTpl":"Current page last modified at: {timeStamp}","createTpl":false,"timeStampFormat":"DD-MMM-YYYY HH:mm:ss"},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"fontsettings":{"family":"sans","size":2,"theme":"white"},"fontSettings":{"size":1},"highlight":{},"copy-code-button":{},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"Service-UVProvenance.md","mtime":"2017-11-20T14:08:24.776Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-12-04T14:08:51.599Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    

    </body>
</html>

